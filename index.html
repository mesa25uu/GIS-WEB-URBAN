<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Urban Map - Oxnehaga</title>
<link rel="stylesheet" href="https://js.arcgis.com/4.29/esri/themes/light/main.css">

<style>
html, body {
  height:100%;
  width:100%;
  margin:0;
  padding:0;
  display:flex;
  font-family:'Segoe UI', sans-serif;
}

#sidePanel {
  width:280px;
  background:#1f2a38;
  color:white;
  padding:20px;
  overflow-y:auto;
}

#viewDiv {
  flex:1;
  height:100vh;
  position:relative;
}

#infoPanel {
  position:absolute;
  top:20px;
  right:20px;
  width:320px;
  max-height:70vh;
  overflow-y:auto;
  background:white;
  border-radius:8px;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  border:1px solid #ccc;
}

.info-header {
  background:#4A90E2;
  color:white;
  padding:10px 15px;
  border-radius:8px 8px 0 0;
  font-weight:bold;
}

#infoContent {
  padding:15px;
  font-size:13px;
}

.layer-item {
  margin-bottom:8px;
  display:flex;
  align-items:center;
  background:rgba(255,255,255,0.1);
  padding:8px;
  border-radius:4px;
}

.layer-item input { margin-right:10px; }

.dropdown { margin-bottom:10px; }

.dropdown-header {
  cursor:pointer;
  font-weight:bold;
  padding:8px;
  background:rgba(255,255,255,0.15);
  border-radius:4px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.dropdown-arrow { transition:0.3s; }

.dropdown-content {
  display:none;
  margin-top:5px;
  padding-left:10px;
}

.attr-key {
  font-weight:bold;
  color:#666;
  width:45%;
  font-size:11px;
  text-transform:uppercase;
}
</style>
</head>

<body>

<div id="sidePanel">
  <h2 style="color:#4A90E2;margin:0;">GIS Web Urban</h2>
  <hr style="opacity:0.2;margin:15px 0;">
  <button id="project4Btn">Open Project 4</button>
  <div id="controls"></div>
</div>

<div id="viewDiv">
  <div id="infoPanel">
    <div class="info-header">Feature Details</div>
    <div id="infoContent">Click on a feature to see all attributes.</div>
  </div>
</div>

<script src="https://js.arcgis.com/4.29/"></script>

<script>
require([
  "esri/Map",
  "esri/views/SceneView",
  "esri/layers/GeoJSONLayer",
  "esri/widgets/Home"
], function(Map, SceneView, GeoJSONLayer, Home) {

const map = new Map({
  basemap:"topo-vector",
  ground:"world-elevation"
});

const view = new SceneView({
  container:"viewDiv",
  map:map,
  camera:{
    position:{ longitude:14.2622409, latitude:57.7781582, z:5000 },
    tilt:45
  },
  popupEnabled:false
});

view.ui.add(new Home({ view:view }), "top-left");


// ---------------- BUS STOP WITH BUS ICON ----------------

const busStopLayer = new GeoJSONLayer({
  url:"Bus_stop.geojson.geojson",
  renderer:{
    type:"simple",
    symbol:{
      type:"picture-marker",
      url:"https://static.arcgis.com/images/Symbols/Transportation/BusStop.png",
      width:"26px",
      height:"26px"
    }
  },
  outFields:["*"]
});


// ---------------- SERVICES MENU ----------------

const controls = document.getElementById("controls");

function createDropdown(title){
  const container=document.createElement("div");
  container.className="dropdown";

  const header=document.createElement("div");
  header.className="dropdown-header";

  const text=document.createElement("span");
  text.innerText=title;

  const arrow=document.createElement("span");
  arrow.innerHTML="â–¶";
  arrow.className="dropdown-arrow";

  header.appendChild(text);
  header.appendChild(arrow);

  const content=document.createElement("div");
  content.className="dropdown-content";

  header.onclick=()=>{
    const open=content.style.display==="block";
    content.style.display=open?"none":"block";
    arrow.style.transform=open?"rotate(0deg)":"rotate(90deg)";
  };

  container.appendChild(header);
  container.appendChild(content);
  controls.appendChild(container);

  return content;
}

function addToggle(label,layers,parent){
  const div=document.createElement("div");
  div.className="layer-item";

  const chk=document.createElement("input");
  chk.type="checkbox";
  chk.checked=true;
  chk.onchange=(e)=>layers.forEach(l=>l.visible=e.target.checked);

  const span=document.createElement("span");
  span.innerText=label;

  div.appendChild(chk);
  div.appendChild(span);
  parent.appendChild(div);
}

const servicesGroup=createDropdown("Services");
addToggle("Bus Stop",[busStopLayer],servicesGroup);

map.add(busStopLayer);


// ---------------- BUTTON ----------------

document.getElementById("project4Btn").onclick = function(){
  window.location.href = "Project4.html";
};

});
</script>

</body>
</html>
